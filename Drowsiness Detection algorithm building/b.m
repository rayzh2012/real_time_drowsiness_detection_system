function [y1] = b(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 13-Feb-2015 00:20:42.
% 
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = 43xQ matrix, input #1
% and returns:
%   y = 2xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-0.579411208629608;-0.589196622371674;-0.736807763576508;-0.54952484369278;0;0;0;0;0;-0.159819006919861;-0.295506298542023;0;0;0;0;0;0;-0.694104492664337;-1.22030508518219;-1.47010207176209;-0.985206723213196;0;0;0;0;0;0;-0.0794289037585258;-0.507396817207336;-0.4595727622509;-0.0765396133065224;0;0;0;0;-0.644164621829987;-1.43093883991241;-1.35110819339752;-0.88575005531311;0;0;0;0];
  x1_step1_gain = [1.28247293250245;1.39496922056714;1.28246979542359;1.24760015558178;6.35041584051982;6.06618554580052;8.43554283310195;5.97820053385139;1.55089155010248;1.27803466288261;1.25118672716564;1.52073919101197;3.33174483218316;3.09097106127808;3.22724198049734;2.9929499693921;2;0.784235558386689;0.642241170417306;0.570435675730959;0.688454802233574;2.31356137415806;2.32822562890043;2.11885476723871;2.49301913107878;2;2;1.27558520754767;0.994369677194668;0.977284059344675;1.2549713478188;2.66044967474649;2.78268300130483;2.61367371359197;2.73048690072407;1.04519346000277;0.76448260545368;0.835646610659091;0.994194434360605;4.81072677612982;5.28152383710658;6.25148478770303;6.45142802868478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.2163843752356218;-1.6359466218594421;0.80947611738056768;0.7950748895264137;0.345603871293229;-0.51576315802475703;0.52308715074849821;1.2925304311027106;-0.88836070701378733;2.5691742074967858];
  IW1_1 = [0.3099195572064013 0.40116882473052373 -0.41578979928230358 -0.6633847950467463 -0.35727096375203465 0.22970812483090158 0.056300682261296267 -0.17342915535376088 -0.61740388030239324 -0.47787889706491399 -1.0976055081118798 -1.6523246968808245 -0.55760550717624124 -0.9205838167077568 -0.15501223184096735 -0.82262768497261196 -0.11219362135841414 0.72566710170221116 0.15289731743776896 -0.22988324617729333 -0.72709261564746042 -0.39824104082569334 -0.17598036805643916 0.11527108152080061 -0.34815474407914865 1.6371188920372903 -0.75933707526397476 0.4263489153060312 0.06469221728220903 -0.72838626334777823 -0.24669566718131095 0.5598782814478338 -0.28928279786538974 -0.19808150419776424 -0.0038108428553107207 0.50451193859615706 -0.32176283572865955 -0.21349024860496313 -0.12372797359051968 -0.14952405090127446 -0.30673757738687657 0.11944321787106105 0.11456613803614021;0.38249813714113579 0.5115060572782254 -0.55020716114296186 1.0179202234829472 -0.93757878335468492 -0.85407795516727769 -1.1680109585262297 1.2860420831124233 -0.31791199467486969 0.040842039773178608 1.0066117900599372 0.59301760497432243 -1.0592719771987837 0.38269752813313729 0.1873905328463889 -0.23426156931047487 -0.17545342286699811 -0.85031234429909552 1.4888856035855056 -1.2309353232474289 -0.12008977092895882 -0.023215775570486017 -0.28401281182186316 0.099400934568701554 -0.3161126531957395 -0.80398380242117706 -1.6462490380961019 0.17666696882790106 -1.1456639197304797 0.78533177283082234 -0.38500977801144737 0.19882154943550512 0.98901504046763178 -0.69687312202321416 0.69915225077808851 0.28649227009128719 -0.22355445714541239 -0.25850248136380588 -0.26119669855147859 0.48794325224351298 -0.79171195765963676 -0.94024129984424099 -0.63549059478944048;-0.25566396469655422 -0.30167003883531857 -0.15166456005361004 0.2005995652433345 -0.015709106525752425 0.2162498319905557 0.25660068250636076 -0.30689062732071248 0.2935825120454833 -0.23311714452963569 0.17427392119744892 -0.13426445745968024 -0.28464807142897314 0.18242497386311107 0.021925732301704613 -0.27585624134802628 -0.11677628558915812 -0.20496984133325233 -0.020054757822829835 -0.22685890549712356 0.074359831308611943 0.02784994727381605 -0.021044988969999311 0.16712161031096479 0.061028689719992847 -0.20634554168652833 -0.25917370006524804 0.30806902469426756 -0.15412019176180203 0.33610095656171507 -0.19739166452331275 0.28835353903770239 -0.051403660307458347 -0.10430326144761415 -0.30071308388187551 0.21133061168587364 0.24164866695737788 0.2051086689398976 0.22262786160330922 -0.34799594555797725 -0.35245172583413159 -0.32112352118774484 -0.32481673183524706;-0.41974066380125119 -0.57870186658371914 0.33807067846547195 0.53561020558613026 -0.0433999697500227 -0.21601220846686084 0.29756029142138857 0.073265228370221383 -0.75068673522779306 -0.36428359227807838 -0.24693081114532109 -0.18660040304460762 -0.12727845666079665 0.23773490435168695 0.54969488478131789 -0.26587127779369518 -0.6238707145935396 0.39220269314031814 -0.85615059746873068 0.40979199499184876 0.25724208540053528 -0.27301574733529982 0.63758472126023436 -0.035097559065190284 -0.11493595464800493 0.55025276050107697 -0.6632702540582528 -0.19454355481860763 0.35327097747743613 -0.2073432914633625 0.087454899333113859 0.08936158851679607 0.055861752681991839 -0.038659625203006254 0.62436297226065818 0.13888490422703798 -0.40352040303176834 -0.2541535785308644 -0.017536612890192784 0.5229487916093033 -0.55324929789692945 0.023328632130695515 0.12514617926944599;-0.10908281214923315 0.043531601103750671 -0.015102673010644318 -0.42482935347919748 0.3119810721914974 -0.33193657924172298 0.36476938309096402 0.3075385114688976 -0.26889160258739703 -0.073731178498489522 -0.34641603240656843 0.37458153880964129 0.34314874370598714 0.57699394139108495 0.31853935106479764 0.35872764349756903 0.36742448310136067 0.44550954578509505 0.13504449469426796 0.15988571077615391 -0.27116762335431738 -0.15138895820755824 0.063004297463142539 0.12107915438248594 -0.15610947720653612 0.2833802949708682 0.83677821448972334 -0.2021418651538282 0.37189909216151473 -0.26705384683380873 0.36953158196713548 -0.15039153448313353 -0.51793337324472244 0.22057735890074365 0.26232946758648434 0.19461895845190866 0.38189118713648096 0.20122749408389304 -0.19666648538692894 -0.021160599748064494 0.36719428769406048 0.034215116876942397 0.71033545298254563;1.21201930358077 0.067915650520351659 0.085821370861120391 0.47124825139587073 0.89296065548183057 -0.010133416740097868 -0.15150070691363662 -0.56013791359145426 0.71024880359428133 0.1704503057135987 0.45955047835634771 1.9738509335145706 0.58551047672695733 0.073725579518270315 -0.51553438624278558 0.7216145586698095 -0.12337067735884454 0.33860033306851312 0.36304956903075891 0.52268194708545646 0.86969622179925044 -0.054879298236409635 0.63574563728552125 0.68982136011100859 0.1176127784040529 0.41911065439670275 0.1300518394429204 0.55497273621215948 0.097259920598399371 0.44029187681234039 0.5277305338079179 0.55685682963971195 -0.24244191212785435 -0.49703492894349416 0.21920192188967993 -0.91447120159023298 -0.58482813610455453 0.30503096156339449 0.40234736502067708 -0.69785880205105932 -0.82221271115414352 0.13062121763278065 -0.58730214038190842;-0.040415604056901547 -0.019949927025955039 0.025031838144731859 -0.2052911568631518 0.12441316400782988 -0.53882654581170097 0.61238105266299314 -0.52420944145028148 0.10792022740403641 0.36752452227870447 -0.0395937174788717 0.19812268917454412 -0.050626220623144744 0.82724996773977699 0.0047788702841845554 0.45848454516762971 0.21568793321358443 0.52554820530445701 -0.058919351597839745 -0.053316227833322023 -0.25354964187556045 0.50672520199717996 0.097677281019800069 0.22957300451204715 0.30226111512021631 0.5136473583536727 0.99552235514559784 -0.47445920396002167 0.137471413749996 -0.11942759981737235 -0.023518468184355261 0.071203331592327473 0.0095612700020314707 0.28394683340181587 0.44430720404214374 -0.51198957424062885 0.1984646850575352 0.017607310467162282 -0.25490954977651725 0.3167588865146268 -0.10303641682039193 0.54537347583522255 0.19971660556185883;1.108878461246757 0.13853546936373443 0.6666117979646683 -0.82167283909937949 2.4204269054588821 0.31364443405739822 -0.10365275872633568 -0.25939067019330891 -1.5760292806823326 0.01136198578531997 -0.63461890579777502 -0.45617031910194145 0.21450167166141001 -0.017451073274369618 0.40365705774055316 0.87509613024226107 -0.092464204466036662 0.18146421053310535 0.52740257841957139 0.47898348229230592 -0.287327035767317 -0.99745760341925138 0.33218953955385194 -0.73131216357185602 0.088347074258840627 -1.2806002714891178 -0.81398171827892385 -1.1798078076358649 0.3367076458377965 0.10883663022153325 -0.19829415274769063 -0.17911124755827071 -0.16399009128013783 -0.038717840893413111 -0.059872620115002474 -0.60826255577005861 -0.19895189559155349 0.5389073910018104 -1.0643715917319003 0.28467613372304423 -0.2755824669594592 0.29790274644127129 0.20687070533816954;-0.17959154627744256 -0.2562475046865057 0.35852260025821692 0.12095567417823877 0.19539224416313589 0.27721144123689045 0.33671274688510489 -0.026642018152168892 -0.36488022517519347 -0.49867298793472076 -0.070849721657537071 -0.17544544198955248 -0.4996157839433028 0.03758458705471926 -0.18155113938327078 -0.63350157193316559 0.12733568326087044 0.15625659015192039 -0.81190445630644048 -0.19273057521860185 -0.015545902705749688 -0.12609287200532393 0.018493709130233682 -0.37286627575068709 0.13150795204289373 -0.55204204954700831 -0.21035684012742689 0.21849457578641743 0.42338141439938631 0.089387972717391143 -0.53941801488166685 -0.46772642509767753 0.3908611857589035 0.20340302666256838 -0.31525678388783285 -0.31983588828605025 0.030642636990425125 -0.031440639818809749 0.00076300204931970157 0.21547099665792332 -0.095257287222984571 -0.28364059505681372 -0.090826041211773761;0.15205835221193573 -0.43509079010956214 -0.84180171082645194 -0.79825583241549458 0.37846577488530608 0.66344657980093302 0.21595880137099382 -0.16360381467917773 0.42369401724946532 0.11756921139624144 0.94007187874634879 -0.65290540950167641 1.3932602278215795 -0.11370745823797669 0.17339298167283038 0.37444964084674781 -0.020507077605843402 -0.87283674071355655 -0.73850281782416272 0.77675293038775639 -0.31722131763603756 -0.70591448801752998 0.69471633580868164 -0.23152007488932852 0.086643668622085612 -1.55398223842443 1.5233649936772331 -0.1239202471208157 0.80293779737597559 0.23424119123301917 0.29325336104497346 0.17310920218497189 -0.56140570361078312 0.9942644769203336 0.35916359012418081 -0.052507768947106216 0.5317491933600017 0.050859099450615675 -0.40493098823012569 0.5406462057738356 0.57607234615242009 -0.011074938169349225 -0.017008858115061892];
  
  % Layer 2
  b2 = [-0.31441335415069027;-0.82315350202184012];
  LW2_1 = [2.5916523220611469 -2.4878942414622123 0.047039054003840682 1.1382175347518342 1.8945008477505334 -2.6821064443719429 1.3597718804699743 2.4062008733493232 1.1339750343677231 3.8733788836279599;-2.3101858361311502 3.1259804739230574 0.43823436017972017 -1.9169169426654926 -0.43299438009353891 1.3194828089293813 -0.99352773128887117 -2.4878194050530831 -0.18052987257706066 -3.8685416700758228];
  
  % ===== SIMULATION ========
  
  % Dimensions
  Q = size(x1,2); % samples
  
  % Input 1
  xp1 = mapminmax_apply(x1,x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
  
  % Layer 1
  a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);
  
  % Layer 2
  a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
  
  % Output 1
  y1 = a2;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numer = exp(n);
  denom = sum(numer,1); 
  denom(denom == 0) = 1;
  a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
