function [y1] =a(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 13-Feb-2015 00:08:06.
% 
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = 43xQ matrix, input #1
% and returns:
%   y = 2xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-0.579411208629608;-0.589196622371674;-0.736807763576508;-0.54952484369278;0;0;0;0;0;-0.159819006919861;-0.295506298542023;0;0;0;0;0;0;-0.694104492664337;-1.22030508518219;-1.47010207176209;-0.985206723213196;0;0;0;0;0;0;-0.0794289037585258;-0.507396817207336;-0.4595727622509;-0.0765396133065224;0;0;0;0;-0.644164621829987;-1.43093883991241;-1.35110819339752;-0.88575005531311;0;0;0;0];
  x1_step1_gain = [1.28247293250245;1.39496922056714;1.28246979542359;1.24760015558178;6.35041584051982;6.06618554580052;8.43554283310195;5.97820053385139;1.55089155010248;1.27803466288261;1.25118672716564;1.52073919101197;3.33174483218316;3.09097106127808;3.22724198049734;2.9929499693921;2;0.784235558386689;0.642241170417306;0.570435675730959;0.688454802233574;2.31356137415806;2.32822562890043;2.11885476723871;2.49301913107878;2;2;1.27558520754767;0.994369677194668;0.977284059344675;1.2549713478188;2.66044967474649;2.78268300130483;2.61367371359197;2.73048690072407;1.04519346000277;0.76448260545368;0.835646610659091;0.994194434360605;4.81072677612982;5.28152383710658;6.25148478770303;6.45142802868478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.708308577121467;1.9326043612420085;-0.8378070455079667;1.9587456763022151;1.7469098484080408];
  IW1_1 = [-0.73525724985750662 -0.27500565224761081 -0.58949016174944235 0.57649490114140967 -0.18088551520504653 -0.16373420247748754 -0.20887945397057314 0.68806179776193388 -0.8300723832992426 -0.67058956984708507 -1.1467122400428087 -0.70070881191700762 0.19110639964282791 0.10274594489617812 -0.28115325477843345 -0.64149870245687091 0.053483492606028304 -0.63426486187295583 -0.60263251436753207 0.19870260490917377 0.57265860436828697 -0.49330146739178693 0.93880190279267639 -0.024119547125348154 0.39647814011319066 -0.84761999610404293 -0.81504817974926569 -0.55249523016491708 0.40392348488415875 -0.34289079695027858 0.55838888842043244 0.35583675233972623 -0.36571931981044242 0.48989427629169535 0.57619094158040696 0.81576597419227226 -0.54217227984964345 0.45670947118809679 0.087512315405898766 0.40804167995122498 0.25849448095532773 0.3626288230646455 0.096806534877921055;-0.64554986935477909 0.27404968228382753 0.29350038629904901 -0.26903668700901395 -0.2591746756193275 0.46840748504422813 0.38041419751888428 0.14975795569456954 -0.26370908191752446 -0.37624021141382863 -0.20375961553038802 -0.4776915744115322 0.299620565113699 0.14451556168088631 0.34285030510598635 -0.66369453603865247 -0.10179976228370786 -0.20988617854737912 -1.4465484405323448 0.95956969484371313 -0.85714551128564009 -0.014700660822072555 -0.030433271548969382 -0.50667269647851609 -0.12572799269077889 -0.83922639266202959 1.3935450218969487 0.12778570397349845 1.3907461813777944 -0.35528445974272455 1.0996349409335135 0.50788430597514278 0.64801529038433825 1.2162363794225031 0.9448605652716876 0.45539852284471627 1.0400984246758649 0.40260886159856163 -0.26969674185613124 -0.27086224307542467 -0.26064827494794074 -0.52934416080972468 0.53905105027551758;0.52026929630787544 0.19976309526579114 0.048288534870342882 1.063431208236687 -0.33410059968511752 -0.38988221153520231 -0.52455251447243256 0.43016624216846461 0.61480764852690761 -1.2029556670797235 -0.30247805079126705 0.62618533043459412 -0.73158295881008972 -0.020572907378096739 0.19313583641996851 -0.60054522181956826 -0.12579188154529555 -0.93512857550623407 1.2648520462641502 -1.3627607284783472 0.21146837188286338 0.27512101099543229 -1.2813764947835664 0.31638430364145537 -0.020056231576856931 -0.77145892884793166 -0.62160973141903786 0.48017125545959766 -1.7202114377423279 0.20081266126274039 -0.99553578976828772 0.20845025359266153 0.77453377319162542 -0.021033789935355866 -0.23182399271535184 0.53022590464362174 0.86717311649694095 -0.45437317903751928 -0.26766492875799935 -0.2876848090459177 -0.51498121399701624 -1.2329961226183954 -0.10535577158961505;-0.55864271379060781 0.30597483881052917 -1.0435649961362012 -1.3513104372807925 0.5981192115218682 0.87713810976192153 -0.01851331744642902 0.11945386056940052 -0.58339034823601876 -0.78994170637100403 -1.2207218565285025 -3.2244385890887024 0.67324693211555975 -0.48566122385099458 -0.0087650901792668354 -0.66816849771321596 0.17400328419387739 0.3725989420780737 0.041996213366675708 -0.42259620846783974 -0.1414716045768965 -1.4052860866702519 -0.65926523196909448 -1.6963125317748151 -0.2118260621459839 -0.48004614916827087 1.0869308264174085 -0.91792876938998191 -0.125631665775084 -0.62383333203860192 -1.5570807097547321 -0.39711770417473846 -0.39853756120662848 0.021046588133539979 -0.59961602235455358 0.87896353187704812 -0.19683971204857464 1.1605062723375819 -0.70528450045195701 0.64017241895881916 0.21451670649464999 1.2605927050740187 -0.21973572741160066;0.93609566577737047 -0.18798918669328551 -0.12184875191935052 -0.99329902592725949 0.73832425549194092 -0.19476065354496344 -0.01340640668573575 -0.41273966167817289 -0.0524887235049801 -0.057024857996313856 -1.0765778263394634 -0.81442862209866385 -0.36844831165678882 -0.2648877539351282 -0.11718293352928123 -0.01622280161867547 -0.22084202565614153 0.21421468360293663 0.37035348272549989 -0.33607338350451377 -0.12293468130518743 -0.30542161955764807 0.11047617092450601 0.52709354164457889 -0.38007968591126401 0.32363449472055333 0.041421316113315149 -0.020255668729113933 -0.61239914831800846 -1.2791284935737186 -0.53675929636855957 -0.08094802847783128 -0.85341220895273662 -0.43176564009846208 -0.31214897334758862 0.0027913882300440174 -0.20535029359006066 -0.60836216649630315 -0.45127659765005934 -0.33038007238665607 -0.14643142807951354 0.038437433836662163 -0.41942315649777268];
  
  % Layer 2
  b2 = [0.15961055165064558;-0.02534248199661298];
  LW2_1 = [1.5920154198961787 3.7190707976432282 -3.9868681149296878 2.2209388044028757 2.4056464866910945;-2.3611070696077552 -3.8550207088933806 2.6828641785064415 -2.5604690037391102 -1.0872764820240999];
  
  % ===== SIMULATION ========
  
  % Dimensions
  Q = size(x1,2); % samples
  
  % Input 1
  xp1 = mapminmax_apply(x1,x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
  
  % Layer 1
  a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);
  
  % Layer 2
  a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
  
  % Output 1
  y1 = a2;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numer = exp(n);
  denom = sum(numer,1); 
  denom(denom == 0) = 1;
  a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
